COMPOSER e AUTOLOAD PSR-4

Composer -> É um gerenciador de dependências, mapea toda a estrutura da aplicação, recupera todas as classe contidas nos scripts e permite o acesso às classes por meio de namespaces;

PSR-4 -> os namespaces devem ter o mesmo nome da pasta;

//Download
https://getcomposer.org/

//executar o composer em um projeto específico
1º clique em download na página acima e irá abrir outra página -> 
2º abaixo de 'Command-line installation', copie o código -> php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');" ;
3º cole no cmd do windows, detalhe importante, no cmd o local do diretório já deve estar setado, conforme 'Resumindo' nos itens 1 e 2 da sessão MVC acima -> caso queira testar, basta copiar o seguinte código no cmd -> php -r "if (hash_file('SHA384', 'composer-setup.php') === '93b54496392c062774670ac18b134c3b3a95e5a5e5c8f1a9f115f203b75bf9a129d5daa8ba6a13e2cc8a1da0806388a8') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;" -> se der tudo certo aparecerá a seguinte mensagem -> Installer verified;
4º para baixar o composer, copie o seguinte código para o cmd -> php composer-setup.php ;
5º irá ser criado na pasta o arquivo chamado composer.phar ;
6º após executar o comando acima, o arquivo composer-setup.php poderá ser deletado simplesmente apertando delete, ou executando o comando php -r "unlink('composer-setup.php');"
no cmd;
7º para instalar o composer dentro do projeto -> criar um arquivo na pasta do projeto chamado -> composer.json;
8º dentro do arquivo composer.json digite:
{
	"name": miniframework, //nome do projeto
	"require": { //define alguns critérios para o nosso projeto
		"php": ">=7.0"
	},
	"authors": [ //autor do projeto
		{
			"name": "Jota",
			"email": jota@teste,.com.br //opcional
		}
	],
	"autoload": { //informa os diretórios que precisam se mapeados para carregar as classes do projeto
		"psr-4": { //informa como os arquivos serão carregados
			"APP\\": "App/", //namespace 'APP' que terá acesso a todas as classes localizada na pasta App da aplicação
			"MF\\": "vendor/MF/" //namespace 'MF' que terá acesso às classes localizadas na pasta vendor/MF/
 		}
	}
}
8º agora, para instalar o composer, basta digitar no CMD -> php composer.phar install
9º após a instalação, será criado os arquivos composer.lock e pasta a vendor

1 - php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
2 - php composer-setup.php
3 - criar arquivo composer.json
4 - digite as informaçãs e namespaces do projeto
5 - php composer.phar install

//autoload
O arquivo autoload.php é responsável por carregar todas as classe da aplicação e é preciso fazer um require_once "../vendor/autoload.php";

//extensão phtml (arquivos da pasta View->index)
Extensão criada para arquivos que contenham php e html

------------------------------------------------------------------------------------------------------------

//Instalando Composer no Windows
1 - https://getcomposer.org/
2 - Getting Started -> 4.Installation - Windows -> Clique em 'Composer-Setup.exe'

//Baixar dependências
1- https://packagist.org/

//Utilizar o Composer e Baixar Dependências
1 - Use um terminal CMD, ou o Git Bash (emula o BASH do Linux no Windows - para instalar - https://git-scm.com/ )
2 - Digite no terminal -> composer init
3 - Serão feitas várias perguntas:
	Package name (<vendor>/<name>) (nome do projeto) -> aperte enter
	Description[] (descrição do projeto) -> aperte enter
	Author (autor do projeto) -> aperte enter
	Minimum Stability [] 
	Package Type  -> aperte enter
	License []: -> aperte enter
	Would you like to define your dependencies -> caso queira começa o projeto com alguma dependência -> aperte enter
	Search for a package -> digite o nome de alguma dependência caso queira instalaralguma,senão basta deixar em branco-> aperte enter -> aparecerá algumas opções, basta escolher ->aperte enter duas vezes
	Would you like to define your dev dependencies ... -> aperte enter
	Aparecerá o seu composer.json e perguntará se confirma a criação -> aperte enter e pronto, será criado um arquivo composer.json
6 - Digite no terminal -> composer install -> criar o composer no projeto e instalar as dependências (caso tenha escolhido alguma)

//Adicionando Dependências
1.1 - A primeira opção é -> acesse https://packagist.org/ -> procure pela dependência e copie o que estiver depois de composer require ... Ex: 
{
    "name": "aecio/curso_udemy_composer",
    "authors": [
        {
            "name": "jotal18",
            "email": "jotal18@hotmail.com"
        }
    ],
    "require": {
    		"phpmailer/phpmailer": "6.0.6", //cole aqui o nome e a versão estável e separe por vígulas as dependências
    		"symfony/var-dumper": "3.3.6"
    }
} 

1.2 - Digite no terminal -> composer update -> espere baixar e atualizar o arquivo composer.json

2 - A segunda opção é -> acesse https://packagist.org/ -> procure pela dependência e copie toda a linha de instalação. Ex: composer require phpmailer/phpmailer -> cole no terminal e aperte enter -> Irá instalar o pacote e atualizará o arquivo composer.json

3 - A terceira opção é -> digite no terminal -> composer require -> aparecerá Search for a package: -> digite a dependência que irá ser baixada -> automaticamente será baixada

//Adicionando dependências estáveis
1 - abra o arquivo composer.json -> acrescente a seguinte linha abaixo de "name"-> "minimum-stability": "stable",
2 - utilize uma das 3 opções acima para instalar a dependência
3 - Há outras opções como: "minimum-stability": "dev, alpha, beta, RC e stable",
4 - É sempre bom colocar "stable", poise baixará a versão última versão estável

//Versionamento de pacotes
1 - O '^' antes da versão significa, no caso abaixo, que será baixado, após o comando composer update, o pacote referente à versão 5.2.16 até 5.2.24. Caso seja tirado o '^', será baixado especificamente aquele pacote e não será atualizado. 
{
    "name": "aecio/curso_udemy_composer",
    "minimum-stability": "stable",
    "authors": [
        {
            "name": "jotal18",
            "email": "jotal18@hotmail.com"
        }
    ],
    "require": {
        "phpmailer/phpmailer": "^5.2.16" //O '^' significa que a dependência será atualizada até a última versão estável daquela versão
    }
}

//Atualizar arquivo composer.json
1 - Após qualquer alteração no arquivo composer.json, este deverá ser atualizado -> digite no terminal -> composer update

//Arquivo Lock
1 - Tudo o que for incluído no composer.json ficará armazenado no arquivo composer.lock
2 - Quando é feito alguma alteração no composer.json, aparecerá no terminal a seguinte mensagem -> Writing lock file

//Chamar dependências em um arquivo
1 - require 'vendor/autoload.php';

//Autoload com PSR-4 do PHP-FIG
1 - PHP-FIG é um site com várias padronizações de código php // PSR-4 (Autoloading Standard) é uma das recomendações desse site
2 - para criar as pastas que serão carregadas pelo autoload -> basta incluir o seguinte código "autoload" abaixo de 'require':

    "autoload": { 
    	"psr-4":{
    		"app\\":"app",                 ("app\\"->representa o namespace, "app" -> é a pasta da classe)
    		"asw\\":["services", "jobs"]   (neste caso, o namespace "asw" poderá ser usado para chamar classes das pastas "services" e "jobs")
	    }
	},


3 - Para criar namespace  -> palavra namespace + \ + nome da pasta + ; -> Ex: namespace app\app;
4 - Para chamar namespace -> use namespace + pasta + nome da classe + ; -> use app\app\Teste;
5 - Após incluir o autoload ou atualizar um namespace será necessário atualizar o arquivo -> digite no terminal -> composer dump-autoload -o -> o 'o' é utlizado para otimizar o autoload
6 - O arquivo com todas os autoloads do composer fica em -> vendor/autoload_psr4.php

//Autoload de Funções
1 - Criar um arquivo que será carregado pelo composer sem precisar de require -> digite, dentro de "autoload" -> 
	"autoload": { 
    	"psr-4":{
    		"app\\":"app",                 ("app\\"->representa o namespace, "app" -> é a pasta da classe)
    		"asw\\":["services", "jobs"]   (neste caso, o namespace "asw" poderá ser usado para chamar classes das pastas "services" e "jobs")
	    },

		"files":["functions/helpers.php", "functions/teste.php"] // dentro do array ([]) deve ser colocado o caminho do arquivo a ser carregado
	},
2 - Após incluir o autoload ou atualizar um namespace será necessário atualizar o arquivo -> digite no terminal -> composer dump-autoload -o -> o 'o' é utlizado para otimizar o autoload



